// app/src/models/orderItem.model.ts

/**
/**
 * OrderItem Model
 * ----------
 * This file defines the Sequelize `OrderItem` model, which represents the `order_items` table in the database.
 *
 * 
 * Contains:
 *  - Model attributes (`OrderItemAttributes`).
 *  - Required attributes for creation (`OrderItemCreationAttributes`).
 *  - Model definition with its columns and constraints.
 * 
 * This model is used by services and controllers to perform CRUD operations.
 */


import { DataTypes, Model, Optional } from "sequelize";
import sequelize from "../config/database";

/**
 *  Main attributes of the `OrderItem` entity.
 */
export interface OrderItemAttributes {
    id_order_item: number;
    order_id: number;
    product_id:number;
    amount: number;
    price: number;
    subtotal: number;
    is_active: boolean;
}

/**
 * Attributes used for creating a new order_item.
 * `Optional` is used to indicate that `id` is not required at the time
 * of creation, as it is automatically generated by the database.
 */

export interface OrderItemCreationAttributes extends Optional<OrderItemAttributes, "id_order_item"> { }




/**
 * Class that represents the `order_item` model in Sequelize.
 * 
 * Implements the attributes defined in `OrderItemAttributes` and `ProductsCreationAttributes`.
 */

class OrderItem extends Model<OrderItemAttributes, OrderItemCreationAttributes> implements OrderItemAttributes {
    /** Unique identifier of the OrderItem (primary key). */
    public id_order_item!: number;
    /** Unique identifier of the category (Foreign key). */
    public order_id!: number;
    /** Unique identifier of the product (Foreign key). */
    public product_id!: number;
    /** Name of the amount */
    public amount!: number;
    /** Name of the order_item */
    public price!: number;
    /** Name of the order_item */
    public subtotal!: number;
    /** Status of the order_item (active/inactive) */
    public is_active!: boolean;
}
/**

 * 
 * Properties include:
 * - `id_order_item`: Primary key, unique identifier for each order item.
 * - `order_id`: Foreign key linking to the related order.
 * - `product_id:  Foreign key linking to the related Product
 * - `amount: amount of the individual order item
 * - `price`: Price of the individual order item.
 * - `description`: Description or details of the order item.
 * - `subtotal`: Calculated subtotal (price * amount) for this order item.
 * - `is_active`: Boolean flag to indicate if the order item is active or inactive.
 * 
 * This class serves as the blueprint for CRUD operations on order items within the database.
 */


OrderItem.init(
    {
        id_order_item: {
            type: DataTypes.INTEGER,
            autoIncrement: true,
            primaryKey: true,
        },
        order_id: {
            type: DataTypes.INTEGER,
            allowNull: false,
            references: {
                model: "order",
                key: "id_order",
            }
        },
        product_id: {
            type: DataTypes.INTEGER,
            allowNull: false,
            references: {
                model: "product",
                key: "id_product",
            }
        },
        amount: {
            type: DataTypes.INTEGER,
            allowNull: false
        },
        price: {
            type: DataTypes.DECIMAL(12, 2),
            allowNull: false,
        },
        subtotal: {
            type: DataTypes.DECIMAL(12, 2),
            allowNull: false,
        },
        is_active: {
            type: DataTypes.BOOLEAN,
            allowNull: false,
            defaultValue: true,
        }
    },
    {
        sequelize,
        modelName: "OrderItem",      // Name of the model in Sequelize
        tableName: "order_item",    // Name of the table in the database (singular)
        timestamps: true,       // includes createdAt and updatedAt
        createdAt: "created_at",
        updatedAt: "updated_at"
    }
);

export default OrderItem;
